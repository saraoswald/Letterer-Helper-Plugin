(()=>{var __webpack_modules__={228:e=>{const t=function(e){if(!(app.documents.length<1))for(var t=app.selection,r=0;r<t.length;r++){var o="InsertionPoint"==t[r].constructorName?t[r].parentTextFrames[0]:t[r],s=app.activeDocument.textPreferences.leadingKeyIncrement,i=e?1:-1;n(o.paragraphs,a(s*i))}},a=function(e){return function(t){t.pointSize=t.pointSize+e;var a=t.leading;parseInt(t.leading)||(a=t.autoLeading/100*t.pointSize),t.leading=a+e}},n=function(e,t){for(var a=0;a<e.count();a++)t(e.item(a))};e.exports={decrease:()=>t(!1),increase:()=>t(!0)}},513:e=>{var t={name:"200% Width",horizontalScale:200};function a(e){return!(e instanceof TextFrame||(alert("Please select only text frames and try again"),0))}function n(e){for(var a=app.activeDocument,n=a.characterStyles.itemByName(t.name),r=n.isValid?n:a.characterStyles.add(t),o=0;o<e.paragraphs.length;o++)for(var s=e.paragraphs[o].characters,i=0;i<s.length;i++){var l=s[i].contents;l!=SpecialCharacters.EM_DASH&&l!=SpecialCharacters.EN_DASH||(e.paragraphs[o].characters[i].contents="-",e.paragraphs[o].characters[i].applyCharacterStyle(r))}}e.exports={main:function(){!function(e){if(!(app.documents.length<1))for(var t=!1,n=app.selection,r=0;r<n.length;r++)try{var o=n[r]instanceof InsertionPoint?n[r].parentTextFrames[0]:n[r],s=a(o);t=t||a(o),s||e(o)}catch(e){console.log(e)}}(n)}}},538:e=>{var t="hasPseudoStroke",a="isStrokeGroup";function n(e){return e.isValid&&"true"===e.extractLabel(t)}function r(e,t){if(!e||!(e instanceof ID.Group)||!e.allPageItems||e.allPageItems.length<1)return!1;for(var a=e.allPageItems,n=0,r=!1;n<a.length;){if(t(a[n])){r=!0;break}n++}return r}function o(e){try{var t=e.allPageItems;e.ungroup();for(var n=0;n<t.length;){if("true"===t[n].extractLabel(a)){t[n].remove();break}n++}return t}catch(e){alert(e)}}function s(e){var t=new Array;if(e instanceof ID.Group&&!n(e)){for(var a=e.allPageItems,r=(new Array,0);r<a.length;r++)n(a[r])&&o(a[r]);t.push(e)}else t.push(o(e));return t}function i(e){return n(e)||r(e,(function(e){return n(e)}))?s(e):function(e){return new Array(function(e){for(var n={name:"Stroke 2pt Paper",strokeWeight:"2pt",strokeColor:"Paper",endJoin:ID.OutlineJoin.ROUND_END_JOIN},o=app.activeDocument.objectStyles.itemByName(n.name),s=o.isValid?o:app.activeDocument.objectStyles.add(n),i=new Array(e),l=e.duplicate(),c=e instanceof ID.TextFrame||r(e,(function(e){return e instanceof ID.TextFrame}))?function(e){if(e instanceof ID.Group){var t=e.allPageItems;e.ungroup();for(var a=new Array,n=0;n<t.length;n++)if(t[n].createOutlines)for(var r=t[n].createOutlines(),o=0;o<r.length;o++)a.push(r[o]);return a}return e.createOutlines()}(l):new Array(l),d=new Array,u=!1,g=0;g<c.length;g++)c[g].applyObjectStyle(s),d.push(c[g]),c[g]instanceof ID.Group?(c[g].insertLabel(a,"true"),i.push(c[g])):u=!0;if(u){var p=null;d.length>1?p=app.activeDocument.groups.add(d):1==d.length&&(p=d[0]),p.insertLabel(a,"true"),i.push(p)}e.bringToFront();var h=app.activeDocument.groups.add(i);return h.insertLabel(t,"true"),h}(e))}(e)}e.exports={main:function(){for(var e,t=!1,a=app.selection,n=new Array,r=0;r<a.length&&!t;r++)if(!(t=!((e=a[r])instanceof ID.TextFrame||e instanceof ID.Group||e instanceof ID.Polygon))){var o=i(a[r]);o&&n.push(o)}}}},459:e=>{const t=function(e,t){var a=e>0?e/(t-1):e;return[250*n(a),250*r(a),250*o(a)]},a=function(e,t){return-16*Math.pow(e-t,2)+1},n=function(e){return e<.25?1:e>=.25&&e<=.5?a(e,.25):e>=.75?a(e,1):0},r=function(e){return e<=.25?a(e,.25):e>=.25&&e<=.5?1:e>=.5&&e<=.75?a(e,.5):0},o=function(e){return e>=.5&&e<=.75?a(e,.75):e>.75?1:0};e.exports={main:function(){for(var e=app.activeDocument.layers,a=0;a<e.length;a++)e[a].layerColor=t(a,e.length)}}},667:(module,__unused_webpack_exports,__webpack_require__)=>{const progressBar=__webpack_require__(905),myDisplayDialog=function(){var doc=app.activeDocument,usersUnits=app.scriptPreferences.measurementUnit;app.scriptPreferences.measurementUnit=ID.MeasurementUnits.PIXELS;var myDialog=app.dialogs.add({name:"Refit Overset Frames"}),pageRangeControl;with(myDialog)with(dialogColumns.add()){with(staticTexts.add({staticLabel:"Fit all the overset frames on:"}),pageRangeControl=radiobuttonGroups.add(),pageRangeControl)radiobuttonControls.add({staticLabel:"All Pages",checkedState:0}),radiobuttonControls.add({staticLabel:"This Page",checkedState:1});staticTexts.add({staticLabel:""})}var myReturn=myDialog.show();if(1==myReturn)try{if(0===pageRangeControl.selectedButton){var pageCount=doc.pages.count();progressBar.start(pageCount);for(var i=0;i<pageCount;i++)fitFramesOnPage(doc.pages.item(i)),progressBar.update(i+1);progressBar.hide()}else fitFramesOnPage(app.activeWindow.activePage)}catch(err){console.log(err)}else myDialog.destroy();app.scriptPreferences.measurementUnit=usersUnits},fitFramesOnPage=function(e){try{for(var t=e.textFrames,a=0;a<t.count();a++){var n=t.item(a);n&&n.overflows&&(n.fit(ID.FitOptions.FRAME_TO_CONTENT),n.overflows&&doFit(n))}}catch(e){console.log(e)}},doFit=function(e){e&&!e.overflows||(expandFrame(e,5),doFit(e))},expandFrame=function(e,t){e.geometricBounds=transformCoords(e.geometricBounds,[-1*t,-1*t,t,t])},transformCoords=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2],e[3]+t[3]]},main=function(){try{myDisplayDialog()}catch(e){console.log(e)}};module.exports={main}},394:(module,__unused_webpack_exports,__webpack_require__)=>{const util=__webpack_require__(923),progressBar=__webpack_require__(905);function myDisplayDialog(){myDialog=app.dialogs.add({name:"Scale Pages"});var supportedPageRangeTypes=["Range","All"],pageRangeControl,pageRangeInput,scaleFactor;with(myDialog)with(dialogColumns.add()){with(dialogRows.add())staticTexts.add({staticLabel:"Resize all text and graphics in unlocked layers."});with(dialogRows.add())staticTexts.add({staticLabel:"Scale Factor:"}),scaleFactor=percentEditboxes.add({editValue:100});with(dialogRows.add())with(staticTexts.add({staticLabel:"Pages:"}),pageRangeControl=radiobuttonGroups.add(),pageRangeControl){for(var i=0;i<supportedPageRangeTypes.length;i++)radiobuttonControls.add({staticLabel:supportedPageRangeTypes[i],checkedState:0==i,minWidth:65});pageRangeInput=textEditboxes.add({editContents:app.activeWindow.activePage.name})}}var myReturn=myDialog.show();if(1==myReturn){var needsReview=!1,selectedPageRange=pageRangeControl.selectedButton,pageRange=0===selectedPageRange?getValidRange(pageRangeInput.editContents):app.activeDocument.pages;0===selectedPageRange&&0===pageRange.length&&(util.showDialog('Please enter a valid page range (e.g. "12, 32-33")'),needsReview=!0),resizePages(scaleFactor.editValue,pageRange),needsReview||myDialog.destroy()}else myDialog.destroy()}function getValidRange(e){for(var t=function(e){var t=e.split("-"),a=parseInt(t[0]),n=parseInt(t[1])||parseInt(t[0]);return!!(t.length>0&&a&&n&&a<=n)&&function(e,t){for(var a=[],n=e;n<=t;n++)a.push(n);return a}(a,n)},a=e.replace(/\s/g,"").split(","),n=[],r=0;r<a.length;r++)for(var o=t(a[r]),s=0;o&&s<o.length;s++){var i=o[s]?app.activeDocument.pages.itemByName(o[s].toString()):{};i.isValid&&n.push(i)}return n.sort()}var selectAllOnPage=function(){if(app.activeWindow.activePage.pageItems.count()<1)return[];var e=filter(app.activeWindow.activePage.pageItems,(function(e){return!e.itemLayer.locked&&!e.locked}));return app.selection=e,e};function isFramePastMargin(e,t){var a=e.marginPreferences,n=e.bounds,r=t.geometricBounds;return r[0]<=n[0]+a.top&&r[1]<=n[1]+a.left&&r[2]>=n[2]-a.bottom&&r[3]>=n[3]-a.right}function getPageBleed(e){var t=app.activeDocument.documentPreferences,a=e.bounds,n=e.side==ID.PageSideOptions.RIGHT_HAND?0:t.documentBleedOutsideOrRightOffset,r=e.side==ID.PageSideOptions.LEFT_HAND?0:t.documentBleedOutsideOrRightOffset;return[a[0]-t.documentBleedTopOffset,a[1]-n,a[2]+t.documentBleedBottomOffset,a[3]+r]}function scaleSelected(e){var t=app.menuActions.itemByName("Increase scale by 1%"),a=app.menuActions.itemByName("Increase scale by 5%"),n=app.menuActions.itemByName("Decrease scale by 1%"),r=app.menuActions.itemByName("Decrease scale by 5%");if(100!==e)if(e>104&&a.enabled)a.invoke(),scaleSelected(e-5);else if(e>100&&t.enabled)t.invoke(),scaleSelected(e-1);else if(e<96&&r.enabled)r.invoke(),scaleSelected(e+5);else{if(!(e<100&&n.enabled))return;n.invoke(),scaleSelected(e+1)}}function resizePages(e,t){if(100!==e){var a;try{a=t.count()}catch(e){a=t.length}progressBar.start(a),forEach(t,(function(t,a){progressBar.update(a+1),app.activeWindow.activePage=t;var n=selectAllOnPage();if(!(n.length<1)){var r=filter(n,(function(e){return isFramePastMargin(t,e)}));scaleSelected(e),r.forEach((function(e){return e.geometricBounds=getPageBleed(t)}))}})),progressBar.hide()}}function filter(e,t){for(var a=[],n=0;n<e.length;n++){var r=e.item?e.item(n):e.at(n);t(r)&&a.push(r)}return a}const forEach=function(e,t){try{for(var a=0;a<e.count();a++)t(e.item(a),a)}catch(n){for(a=0;a<e.length;a++)t(e[a],a)}},main=function(){try{myDisplayDialog()}catch(e){util.showDialog(e,"Error")}};module.exports={main}},346:e=>{function t(e){if(!(app.documents.length<1)){for(var t=!1,a=app.selection,n=0;n<a.length&&!t;n++){var r=a[n],o="TextFrame"!==r.constructorName;t=t||o,o||(r.absoluteRotationAngle+=e,r.absoluteShearAngle+=e)}t&&console.log("Some selections were not text frames and were skipped")}}e.exports={left:()=>t(-1),right:()=>t(1)}},275:(module,__unused_webpack_exports,__webpack_require__)=>{const util=__webpack_require__(923);var defaults={oddPages:{enabled:!0,scale:!1,scaleFactor:100,shiftRight:0,shiftDown:0},evenPages:{enabled:!0,scale:!1,scaleFactor:100,shiftRight:0,shiftDown:0},pageRange:1};function myDisplayDialog(){myDialog=app.dialogs.add({name:"Layout Pages"});var supportedPageRangeTypes=["Range","All"],pageRangeControl,pageRangeInput,oddPages={},evenPages={};with(myDialog){with(dialogColumns.add()){with(oddPages.enabledCheckbox=enablingGroups.add({staticLabel:"Odd Pages",checkedState:defaults.oddPages.enabled}),oddPages.enabledCheckbox){with(dialogColumns.add())oddPages.scaleCheckbox=checkboxControls.add({checkedState:defaults.oddPages.scale,staticLabel:"Set Image Scale:"}),staticTexts.add({staticLabel:"Shift Right:"}),staticTexts.add({staticLabel:"Shift Down:"});with(dialogColumns.add())oddPages.scaleFactor=percentEditboxes.add({editValue:defaults.oddPages.scaleFactor}),oddPages.shiftRight=measurementEditboxes.add({editValue:defaults.oddPages.shiftRight}),oddPages.shiftDown=measurementEditboxes.add({editValue:defaults.oddPages.shiftDown})}with(borderPanels.add())with(staticTexts.add({staticLabel:"Pages:"}),pageRangeControl=radiobuttonGroups.add(),pageRangeControl){for(var i=0;i<supportedPageRangeTypes.length;i++)radiobuttonControls.add({staticLabel:supportedPageRangeTypes[i],checkedState:defaults.pageRange==i,minWidth:65});pageRangeInput=textEditboxes.add({editContents:app.activeWindow.activePage.name})}}with(dialogColumns.add())with(evenPages.enabledCheckbox=enablingGroups.add({staticLabel:"Even Pages",checkedState:defaults.evenPages.enabled}),evenPages.enabledCheckbox){with(dialogColumns.add())evenPages.scaleCheckbox=checkboxControls.add({checkedState:defaults.oddPages.scale,staticLabel:"Set Image Scale:"}),staticTexts.add({staticLabel:"Shift Right:"}),staticTexts.add({staticLabel:"Shift Down:"});with(dialogColumns.add())evenPages.scaleFactor=percentEditboxes.add({editValue:defaults.evenPages.scaleFactor}),evenPages.shiftRight=measurementEditboxes.add({editValue:defaults.evenPages.shiftRight}),evenPages.shiftDown=measurementEditboxes.add({editValue:defaults.evenPages.shiftDown})}}var myReturn=myDialog.show();if(1==myReturn){var needsReview=!1,selectedPageRange=pageRangeControl.selectedButton,pageRange=0===selectedPageRange?getValidRange(pageRangeInput.editContents,oddPages.enabledCheckbox.checkedState,evenPages.enabledCheckbox.checkedState):app.activeDocument.pages,regex=/\d{3,4}(?=\_?\d?\d?[a-zA-Z]?\.[A-Za-z]{3,4})/;0===selectedPageRange&&0===pageRange.length&&(util.showDialog('Please enter a valid page range (e.g. "12, 32-33")',"Error"),needsReview=!0);var transformPage=function(e,t){t.scaleCheckbox.checkedState&&scalePage(e,parseInt(t.scaleFactor.editValue)),shiftPage(e,parseInt(t.shiftRight.editValue),parseInt(t.shiftDown.editValue))};try{for(var i=0;i<pageRange.length;i++){var page=pageRange[i];transformPage(page,parseInt(page.name)%2>0?oddPages:evenPages)}}catch(err){for(var i=0;i<pageRange.count();i++){var page=pageRange.item(i);transformPage(page,parseInt(page.name)%2>0?oddPages:evenPages)}}needsReview||myDialog.destroy()}else myDialog.destroy()}function getValidRange(e,t,a){for(var n=function(e){var t=e.split("-"),a=parseInt(t[0]),n=parseInt(t[1])||parseInt(t[0]);return!!(t.length>0&&a&&n&&a<=n)&&function(e,t){for(var a=[],n=e;n<=t;n++)a.push(n);return a}(a,n)},r=e.replace(/\s/g,"").split(","),o=[],s=0;s<r.length;s++)for(var i=n(r[s]),l=0;i&&l<i.length;l++){var c=i[l],d=c?app.activeDocument.pages.itemByName(c.toString()):{};(d.isValid&&t&&c%2>0||a&&c%2==0)&&o.push(d)}return o.sort()}function scalePage(e,t){if(e.isValid&&NaN!==t)for(var a=e.allGraphics,n=0;n<a.length;n++){var r=a[n];isFramePastMargin(e,r.parent)&&(r.absoluteHorizontalScale=t,r.absoluteVerticalScale=t)}}function shiftPage(e,t,a){if(0!==t||0!==a)for(var n=0;n<e.allGraphics.length;n++){var r=e.allGraphics[n];isFramePastMargin(e,r.parent)&&r.move(void 0,[t,a])}}function isFramePastMargin(e,t){var a=getBounds(e.bounds),n=getBounds(t.geometricBounds);return n.height>=a.height&&n.width>=a.width}function getBounds(e){return{width:e[2]-e[0],height:e[3]-e[1]}}const main=function(){try{var e=app.scriptPreferences.measurementUnit;app.scriptPreferences.measurementUnit=ID.MeasurementUnits.POINTS,0===app.activeDocument.allGraphics.length?util.showDialog("Could not find any linked graphics in this document."):0!=app.documents.length&&myDisplayDialog(),app.scriptPreferences.measurementUnit=e}catch(e){console.log(e)}};module.exports={main}},905:e=>{e.exports={start:function(e){const t=document.getElementById("progress_bar");t.className="w-5",t.setAttribute("max_value",e)},update:function(e){const t=document.getElementById("progress_bar"),a=e/t.getAttribute("max_value")*100,n=5*Math.round(a/5);t.className=`w-${n}`},hide:function(){document.getElementById("progress_bar").className="hidden"}}},146:e=>{function t(e,t){var a=e.charCodeAt(t),n=t;if(123===a)return 513;if(125===a)return 769;if(92===a){var r=1;for(a=e.charCodeAt(++t);a>=97&&a<=122;a=e.charCodeAt(++t))r++;if(1===r){if(42===a)return 1026;if(39===a){if(t+2>e.length)return e.length-t+2;var o=e.charCodeAt(++t),s=e.charCodeAt(++t);if(!(o>=48&&o<=57||o>=65&&o<=70||o>=97&&o<=102)||!(s>=48&&s<=57||s>=65&&s<=70||s>=97&&s<=102))return 4;var i,l=String.fromCharCode(o,s).match(/.{1,4}/g)||[],c="";for(i=0;i<l.length;i++)c+=String.fromCharCode(parseInt(l[i],16));return 133==(c=c.charCodeAt(0))&&(c=8230),150==c&&(c=8211),151==c&&(c=8212),1<<31|c+32768<<15|1796}return 92!=a&&45!=a&&58!=a&&95!=a&&a<123&&a>126?2:1<<31|a+32768<<15|1282}if(2==r&&117==e.charCodeAt(n+1)){c="";for(var d=a,u=n+2;d&&u<n+15&&!((d=e.charCodeAt(u))<=47||d>=58);)c+=e.charAt(u),u++;var g=c.length;return 1<<31|(c=parseInt(c))+32768<<15|1280|g+2}if(45===a||a>=48&&a<=57){var p=r,h=t;for(a=e.charCodeAt(++t);t<e.length;a=e.charCodeAt(++t))if(r++,45!==a&&(a<48||a>57)){32===a&&r++;break}var f=parseInt(e.slice(h,t));return 1<<31|(f+=32768)<<15|p-2<<11|1536|r}return 32===a?++r-3<<11|1536|r:r-2<<11|1536|r}if(10===a||13===a){for(r=1,a=e.charCodeAt(++t);t<e.length&&(10===a||13===a)&&255!=++r;a=e.charCodeAt(++t));return-1073314560|r}for(r=1,a=e.charCodeAt(++t);t<e.length&&92!==a&&123!==a&&125!==a&&13!==a&&10!==a&&255!=++r;a=e.charCodeAt(++t));return 256|r}function a(e){return e>>8&7}function n(e,t,a){return t.substr(a,255&e)}function r(e,t,a){return 1536!=(1792&e)?null:t.substr(1+a,1+(e>>11&15))}function o(e){return 0==e>>31?NaN:(e>>15&65535)-32768}function s(e,a,n){null==n&&(n=0);var r=a,o=0;for(r=a;r<e.length;r+=o){var s=t(e,r),i=(o=255&s,s>>8&7);if(2===i)n++;else if(3===i){if(0===n){r+=o;break}n--}}return r}function i(e,l,c){var d=i.prototype;if(!0!==d.__PtInit&&(d.Template=function(e,t,a,n){},d.HandleDest=function(e,t){this.dhc={},this._chit=0,this._cmis=0;var a=null;if(RegExp===e.constructor){var n=e.toString();for(a=0;a<this.dhr.length&&(this.dhr[a+1]!==t||this.dhr[a].toString()!==n);a+=2);a==this.dhr.length&&(this.dhr.push(e),this.dhr.push(t))}else{if(String!==e.constructor)throw Error("RtfParser::HandleDest: Invalid destination param");var r=this.dhd[e];if(null==r)r=this.dhd[e]=[t];else{for(a=0;a<r.length&&r[a]!==t;a++);a==r.length&&r.push(t)}}},d.Handlers=function(e,t,a,n,r){if(this.dhc.hasOwnProperty(r))return this._chit++,this.dhc[r];this._cmis++;var o=[],s=this.dhd[n];null!=s&&(o=o.concat(s)),null!=(s=this.dhd[r])&&(o=o.concat(s));for(var i=null,l=0;l<this.dhr.length;l+=2){var c=this.dhr[l+1];for(i=0;i<o.length&&o[i]!==c;i++);i<o.length||this.dhr[l].test(r)&&o.push(c)}return 0===o.length?this.dhc[r]=null:this.dhc[r]=o},d.Document=function(e){if(!0===e||this.pos===this.txt.length)return this.doc;for(var a,n,o;this.pos<this.txt.length;this.pos+=n)if(n=255&(a=t(this.txt,this.pos)),2==(o=a>>8&7)){var i=a,l=this.pos;this.pos+=n,n=255&(a=t(this.txt,this.pos)),4==(o=a>>8&7)&&(this.pos+=n,n=255&(a=t(this.txt,this.pos)),o=a>>8&7);var c={tok:a,pos:this.pos,ctl:r(a,this.txt,this.pos),doc:this.doc,stk:this.stk};if(0===this.stk.length?c.pth=";"+c.ctl:c.pth=this.stk[this.stk.length-1].pth+";"+c.ctl,c._dh=this.Handlers(a,this.txt,this.pos,c.ctl,c.pth),null==c._dh)this.pos=s(this.txt,this.pos),n=0;else{this.frm=c,this.stk.push(c);for(var d=0;d<c._dh.length;d++)c._dh[d](i,this.txt,l,c)}}else if(3===o){if(0===this.stk.length)throw Error("RtfParser: Too many closing braces!");for(d=0;d<(this.frm._dh||[]).length;d++)this.frm._dh[d](a,this.txt,this.pos,this.frm);this.stk.pop(),0===this.stk.length?this.frm=null:this.frm=this.stk[this.stk.length-1]}else if(null!=this.frm)for(d=0;d<(this.frm._dh||[]).length;d++)this.frm._dh[d](a,this.txt,this.pos,this.frm);return this.doc},d.HandlePcData=function(e,t,r,o){if(513!==e){if(769===e){var s=o.stk[o.stk.length-2];return s[o.ctl]=o.dat.join(""),void dtrace("#PCDATA "+o.ctl+'="'+s[o.ctl]+'"')}var i=a(e);if(1!==i)throw Error("RtfParser: Unexpected type ("+i+') in "'+o.ctl+'" #PCDATA');o.dat.push(n(e,t,r))}else o.dat=[]},d.HandleIgnore=function(){},d.__PtInit=!0),null==e)throw Error("RtfParser: Missing source RTF string");return this.txt=e,this.pos=0,this.doc={},this.stk=[],this.frm={},this.dhd={},this.dhr=[],this.dhc={},this._chit=0,this._cmis=0,void(!0!==c&&(this.HandleDest(";rtf",(function(e,t,a,n){if(513!==e){var s=r(e,t,a);switch(s){case"ansi":case"mac":case"pc":case"pca":n.doc.charset=s;break;case"ansicpg":n.doc.codepage=o(e);break;case"deff":n.doc.deff=o(e)}}else n.doc.ver=o(n.tok)})),this.HandleDest(";rtf;fonttbl",u),this.HandleDest(";rtf;fonttbl;f",u),this.HandleDest(";rtf;colortbl",(function(e,t,a,s){if(513!==e){if(769!==e){var i=e>>8&7;if(1!==i){if(6===i){var l=r(e,t,a),c=o(e);if("red"==l)s.color.r=c;else if("green"==l)s.color.g=c;else{if("blue"!=l)throw Error("Unrecognized token in color table: "+n(e,t,a));s.color.b=c}}}else";"==n(e,t,a)&&(s.color={r:0,g:0,b:0},s.doc.colors.push(s.color))}}else null==s.doc.colors&&(s.color={r:0,g:0,b:0},s.doc.colors=[s.color])}))));function u(e,t,a,s){var i=null,l=null;if(513===e?(null==s.doc.fonts&&(s.doc.fonts=[]),l=r(s.tok,t,s.pos),i=o(s.tok)):(l=r(e,t,a),i=o(e)),1==(e>>8&7)){var c=n(e,t,a);return s.font.name=c,void(";"==s.font.name.charAt(s.font.name.length-1)&&(s.font.name=s.font.name.substr(0,s.font.name.length-1)))}switch(l){case"f":s.font=s.doc.fonts[i]=new Object;break;case"fnil":case"froman":case"fswiss":case"fmodern":case"fscript":case"fdecor":case"ftech":case"fbidi":s.font.family=l.substr(1);break;case"fcharset":s.font.charset=i;break;case"fprq":s.font.pitch=i;break;case"ftnil":case"fttruetype":s.font.type=l.substr(2);break;case"cpg":s.font.codepage=i}}}e.exports=function(e,t,s,l){var c=new i(e);if(null==l&&(l=2),2!=l)throw Error("HTML version "+l+" not supported");return c.HandleDest(";rtf",d),c.HandleDest("pn",(function(e,t,a,n){513===e&&(n.stk[n.stk.length-2].bullets=!0)})),c.HandleDest("pntxtb",c.HandleIgnore),c.HandleDest("pntext",c.HandleIgnore),c.HandleDest(";rtf;object",(function(e,t,a,n){if(513!==e&&769!==e){var s=r(e,t,a);switch(o(e),s){case null:case"objemb":case"objclass":case"objw":case"objh":break;default:WScript.Echo("Unhandled CTL: "+s)}}})),c.HandleDest(";rtf;listtext",(function(e,t,a,n){})),c.HandleDest(";rtf;object;objclass",c.HandlePcData),c.HandleDest(";rtf;object;objdata",(function(e,t,a,n){if(769===e&&"Package"==n.stk[n.stk.length-2].objclass)for(var r=n.pos+function(e){return 255&e}(n.tok),o=function(e,t,a){var n={},r=t,o=null,s=null;if(17104896!=(s=m()<<28|m()<<24|m()<<20|m()<<16|m()<<12|m()<<8|m()<<4|m()))throw Error("Expected: 01 05 00 00; Instead: "+s.toString(16));if(2!==(s=g()))throw Error("Expected: 02 00 00 00 (2); Instead: "+s);if(n.progid=h(!0),trace('RtfPkgOb:ProgID = "'+n.progid+'"'),0!=g()||0!=g())throw Error("Expected two zero numbers!");if(n.totalsz=g(),trace("RtfPkgOb:Total Size = "+n.totalsz),n.totalsz<2||n.totalsz>1048576)throw Error("RtfPkgOb: Invalid Size "+n.totalsz);var i=0;if(n.strings=new Array(p()),i+=2,dtrace("RtfPkgOb:Strings.length = "+n.strings.length),n.strings.length<2||n.strings.length>10)throw Error("RtfPkgOb:Invalid Strings.length ("+n.strings.length+")");for(var l=0;l<n.strings.length;l++)n.strings[l]=f(),i+=n.strings[l].length,i++,trace("RtfPkgOb:Strings["+l+'] = "'+n.strings[l]+'"');if(n.label=n.strings[0],i+=2,0!=p())throw Error("RtfPkgOb:Expected Double-Zero's After Strings");if(n.oletype=p(),i+=2,trace("RtfPkgOb:OLE Type = "+n.oletype),1!==n.oletype&&3!==n.oletype)throw Error("RtfPkgOb: Unsupported OLE Type ("+n.oletype+")");var c;if(3===n.oletype)for(n.items=[];r<a&&(dtrace(n.items.length+". ("+i+" / "+n.totalsz+")"),i+=(d={path:h(!0)}).path.length,i+=5,dtrace("Path="+d.path),d.data=h(!1),i+=d.data.length,i+=4,n.items.push(d),i!=n.totalsz-2););else if(1===n.oletype){for(n.items=new Array(p()),i+=2,dtrace("Items Length == "+n.items.length),l=0;l<n.items.length;l++){var d={path:f()};trace("Item Path ["+l+"]: "+d.path),i+=d.path.length,i++,d.path.indexOf("~")>=0&&(trace("Reset Item Path to "+n.label),d.path=n.label),n.items[l]=d}if(i!=n.totalsz-2)throw Error("RtfPkgOb: Wasted Data ("+(n.totalsz-2-i)+")")}if(0!=(c=p()))throw Error("RtfPkgOb: Invalid Terminator ("+c+")");for(var u=0;u<n.items.length;u++)l=(d=n.items[u]).path.lastIndexOf("\\"),d.name=l>0?d.path.substr(l+1):d.path;return n;function g(){return m()<<4|m()|m()<<12|m()<<8|m()<<20|m()<<16|m()<<28|m()<<24}function p(){return m()<<4|m()|m()<<12|m()<<8}function h(e){var t=g();if(dtrace("Len: "+t+" ("+r+", "+a+")"),r+t>a)throw Error("RtfPkgOb/bstr_: Out of Data");for(var n=[],o=0,s=[];r<a;){var i=m()<<4|m();if(n.push(i),++o>=t)break;n.length>500&&(s.push(String.fromCharCode.apply(null,n)),n=[])}n.length>0&&(s.push(String.fromCharCode.apply(null,n)),n=[]);var l=s.join("");if(!0===e){if(0!==l.charCodeAt(l.length-1))throw Error("RtfPkgOb/bstr_: Unterminated String ("+l.charCodeAt(l.length-1)+")");l=l.substr(0,l.length-1)}return l}function f(){for(var e=[],t=[];r<a;){var n=m()<<4|m();if(0==n)break;e.push(n),e.length>500&&(t.push(String.fromCharCode.apply(null,e)),e=[])}return e.length>0&&(t.push(String.fromCharCode.apply(null,e)),e=[]),t.join("")}function m(){do{o=e.charCodeAt(r++)}while(32===o||13===o||10===o);if(o>=48&&o<=57)return o-48;if(o>=65&&o<=90)return o-55;if(o>=97&&o<=122)return o-87;if(r>=a)throw Error("RtfPkgObj/hx_: Out of Data");throw Error("RtfPkgOb/hx_: Unexpected Code ("+o+"): '"+e.charAt(r-1)+"' @ "+r+" / "+a)}}(t,r,a),s=0;s<o.items.length;s++){var i=o.items[s];null!=n.doc.outo&&(null==n.doc.outo.files?n.doc.outo.files=[i]:n.doc.outo.files.push(i)),i.name.match(/\.(gif|png|jpe?g)$/i)?n.doc.limg=i:n.doc.sbhtml.push('{<A HREF="'+n.doc.baseurl+o.items[s].name+'">'+o.items[s].name+"</A>}")}})),c.HandleDest(";rtf;object;result",c.HandleIgnore),c.HandleDest(";rtf;rtlch",d),c.HandleDest(";rtf;fonttbl;fbiminor",c.HandleIgnore),c.HandleDest(";rtf;fonttbl;fhiminor",c.HandleIgnore),c.HandleDest(";rtf;fonttbl;fdbminor",c.HandleIgnore),c.HandleDest(";rtf;fonttbl;flominor",c.HandleIgnore),c.HandleDest(";rtf;fonttbl;fbimajor",c.HandleIgnore),c.HandleDest(";rtf;fonttbl;fhimajor",c.HandleIgnore),c.HandleDest(";rtf;fonttbl;fdbmajor",c.HandleIgnore),c.HandleDest(";rtf;fonttbl;flomajor",c.HandleIgnore),c.HandleDest(";rtf;mmath",c.HandleIgnore),c.HandleDest(";rtf;info;vern",c.HandleIgnore),c.HandleDest(";rtf;info;author",c.HandleIgnore),c.HandleDest(";rtf;info;nofpages",c.HandleIgnore),c.HandleDest(";rtf;info;nofwords",c.HandleIgnore),c.HandleDest(";rtf;info;nofcharsws",c.HandleIgnore),c.HandleDest(";rtf;info;nofchars",c.HandleIgnore),c.HandleDest(";rtf;info;edmins",c.HandleIgnore),c.HandleDest(";rtf;info;version",c.HandleIgnore),c.HandleDest(";rtf;info;revtim",c.HandleIgnore),c.HandleDest(";rtf;info;creatim",c.HandleIgnore),c.HandleDest(";rtf;info;operator",c.HandleIgnore),c.HandleDest(";rtf;info",c.HandleIgnore),c.HandleDest(";rtf;stylesheet",c.HandleIgnore),c.HandleDest(";rtf;stylesheet;s",c.HandleIgnore),c.HandleDest(";rtf;stylesheet;ql",c.HandleIgnore),c.HandleDest(";rtf;object;result;pict",c.HandleIgnore),c.Document(!0).baseurl=t,c.Document(!0).outo=s,c.Document().html;function d(e,t,s,i){513===e?(i.newpara=!0,i.html=i.doc.sbhtml=[]):769===e&&(u(),i.doc.html=i.doc.html||"",i.doc.html+=i.html.join(""));var l=a(e);if(1===l)return null!=i.par_beg&&(i.html.push(i.par_beg),i.par_beg=null),1==i.newpara&&(i.lastpari=i.html.length,i.newpara=!1),void i.html.push(n(e,t,s));if(5!==l)if(7!==l){var c=r(e,t,s),d=o(e);switch(c){case"pard":u();break;case"tab":i.html.push("\t");break;case"li":case"f":break;case"line":i.html.push("\n");break;case"par":i.newpara=!0,null==i.par_end&&i.html.push("\n"),i.html.push(i.par_end),i.par_end=null;break;case"b":0===d?i.html.push("</B>"):i.html.push("<B>");break;case"i":0===d?i.html.push("</I>"):i.html.push("<I>");break;case"u":0===d?i.html.push("</EM>"):i.html.push("<EM>")}}else i.html.push(function(e){return String.fromCharCode((e>>15&65535)-32768)}(e));else i.html.push(function(e,t,a){return 1792!=(1792&e)&&1280!=(1792&e)?null:String.fromCharCode((e>>15&65535)-32768)}(e));function u(){i.newpara=!0,i.bulletline=!1,i.par_beg=null}}}},656:(e,t,a)=>{a(881);const n=a(459),r=a(346),o=a(228),s=a(667),i=a(394),l=a(275),c=a(513),d=a(538),u=a(997);e.exports={setRainbowLayers:n.main,skewFrame:r,adjustSizeAndLeading:o,refitOversetFrames:s.main,scalePages:i.main,positionArt:l.main,mangaEmDash:c.main,pseudoStroke:d.main,typeset:u}},997:(e,t,a)=>{const n=window.localStorage,r=a(923),o=!1,s={name:"Bold",fontStyle:"Bold"},l={name:"Italic",fontStyle:"Italic"},c={name:"Bold Italic",fontStyle:"Bold Italic"};let d,u,g,p,h;function f(){const e=document.getElementById("typeset_tool"),t=e.querySelector(".overlay.settings"),a="none"!=t.style.display;e.classList.toggle("settings_open"),t.style.display=a?"none":"",a&&I&&I.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}app.scriptPreferences.measurementUnit=ID.MeasurementUnits.PIXELS;const m=["setting_paste_mode","setting_fit_overset_frames"],v={setting_paste_mode:"paste_rich",setting_fit_overset_frames:"always"};function y(e){o&&console.log(e.target.id+" - "+e.target.value),n.setItem(e.target.id,e.target.value)}async function b(){if(fsProvider.isFileSystemProvider)try{const t=await fsProvider.getFileForOpening({types:["txt","rtf"]});if(!t)return w(),!1;let n;try{n=await t.read()}catch(e){n=await t.read({format:formats.binary})}return D(),w(),e=t.name,h=e,function(e,t){p={};let n=t.split(".").pop();try{if("txt"==n)return _(e);if("rtf"==n)return function(e){e=(e=(e=e.replaceAll(/(\\u\d{4}) \}/gi,"$1}")).replaceAll(/\\'9[12]/gi,"'")).replaceAll(/\\'9[34]/gi,'"');return _(a(146)(e))}(e)}catch(e){return console.log(e),r.showDialog("An error occurred while parsing the script.<br>"+e.message,"Error"),!1}}(n,t.name)}catch(e){console.log(e),text||r.showDialog("An error occurred while loading the script file.<br>"+e.message,"Error")}var e}function _(e){o&&(console.log("---- parsing -----"),console.log(e));const t=e.split("\n");let a={},n=1,r=0,s=0;return t.forEach((e=>{if(e.length<1||e.toLowerCase().startsWith("page"))return;if(e=e.replaceAll(/(\r\n|\n|\r)/gm,""),b_closes=(e.match(/<\/B>/g)||[]).length,b_opens=(e.match(/<B>/g)||[]).length,b_closes>b_opens)for(var t=0;t<b_closes-b_opens;t++)lastIndex=e.lastIndexOf("</B>"),e=e.substring(0,lastIndex)+e.substring(lastIndex+4,e.length);if(i_closes=(e.match(/<\/I>/gi)||[]).length,i_opens=(e.match(/<I>/gi)||[]).length,i_closes>i_opens)for(t=0;t<i_closes-i_opens;t++)lastIndex=e.toUpperCase().lastIndexOf("</I>"),e=e.substring(0,lastIndex)+e.substring(lastIndex+4,e.length);let o=e.split("\t"),i=parseFloat(o[0])||r,l=Math.floor(i);l?l!=s&&(s=l):l=s,r=i;let c=a[l]||{},d=c[i]||[];(parseFloat(o[0])||""==o[0])&&o.shift(),d.push(o),n<o.length&&(n=o.length),c[i]=d,a[l]=c})),o&&console.log(a),[a,n]}function w(e){let t=document.getElementById("typeset_tool"),a=t.querySelector(".overlay.loading");void 0!==e?e?t.classList.add("loading"):t.classList.remove("loading"):e=t.classList.toggle("loading"),a.style.display=e?"":"none"}var S=!1,I=null;function P(){try{S=!0;let e=document.getElementById("typeset_tool");e.querySelector(".control_wrapper .start").style.display="none",e.querySelector(".control_wrapper .stop").style.display="";const t=function(e){let t=n.getItem(h);if(t)return t=JSON.parse(t),t.lastSelection}();let a=null;t?(a=e.querySelector(".table_body").querySelector(`.table_cell[cell-id="${t}"]`),a&&a.classList.add("history-selection")):a=I||e.querySelector(".table_body").querySelector(".table_cell"),x(a),e.querySelector(".table_wrapper").classList.add("pasting")}catch(e){console.log(e),r.showDialog("An error occurred while starting to paste.<br>"+e.message,"Error")}}function D(){S=!1;let e=document.getElementById("typeset_tool");e.querySelector(".control_wrapper .start").style.display="",e.querySelector(".control_wrapper .stop").style.display="none",I&&function(e,t){let a=n.getItem(h);a=a?JSON.parse(a):{},a.lastSelection=t,a=JSON.stringify(a),n.setItem(h,a)}(0,I.getAttribute("cell-id")),x(void 0),e.querySelector(".table_wrapper").classList.remove("pasting")}function k(e){if(!S)return;let t=e.target.closest(".table_cell");document.querySelectorAll(".table_cell.history-selection").forEach((e=>e.classList.remove("history-selection"))),x(t)}function x(e){document.getElementById("typeset_tool").querySelector(".table_body").querySelectorAll(".table_cell.selected").forEach((e=>e.classList.remove("selected"))),I=e,e&&(I.classList.add("selected"),I.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}))}function R(e="next"){const t=I.getAttribute("page-id"),a=I.getAttribute("column-id"),n=I.getAttribute("row-id"),r="prev"==e?-1:1;let o=`.table_cell[page-id="${t}"][column-id="${a}"][row-id="${parseInt(n)+r}"]`,s=document.querySelector("#typeset_tool .table_body").querySelector(o);return s||(o=`.table_cell[page-id="${t}"][column-id="${a}"][row-id="${parseInt(n)+2*r}"]`,s=document.querySelector("#typeset_tool .table_body").querySelector(o)),s||(o=`.table_cell[page-id="${parseInt(t)+r}"][column-id="${a}"][row-id="0"]`,s=document.querySelector("#typeset_tool .table_body").querySelector(o)),s||(o=`.table_cell[page-id="${parseInt(t)+r}"][column-id="${a}"][row-id="1"]`,s=document.querySelector("#typeset_tool .table_body").querySelector(o)),s||(o=`.table_cell[page-id="${parseInt(t)+r}"][column-id="${a-1}"][row-id="1"]`,s=document.querySelector("#typeset_tool .table_body").querySelector(o)),x(s),s}function C(){b().then((e=>{e?function(e,t){if(e)try{const s=document.getElementById("typeset_tool"),i=s.querySelector(".overlay"),l=s.querySelector(".control_wrapper"),c=s.querySelector(".table_wrapper"),d=c.querySelector(".table_head"),u=c.querySelector(".table_body"),g=s.querySelector("#template_head div").cloneNode(!0),h=s.querySelector("#template_page div").cloneNode(!0),f=h.querySelector(".table_page_panel").cloneNode(!0),m=f.querySelector(".table_row").cloneNode(!0),v=m.querySelector(".table_cell").cloneNode(!0);function a(e){let t,a,r;e.addEventListener("mousedown",(function(e){a=e.target.parentElement,t=e.pageX;let o=function(e){if("border-box"==n(e,"box-sizing"))return 0;var t=n(e,"padding-left"),a=n(e,"padding-right");return parseInt(t)+parseInt(a)}(a);r=a.offsetWidth-o})),document.addEventListener("mousemove",(function(e){if(a){let n=e.pageX-t,o=r+n+"px",s=a.getAttribute("column-id");c.querySelectorAll(`.table_cell[column-id="${s}"]`).forEach((e=>{e.style.minWidth=o,e.style.maxWidth=o}))}})),document.addEventListener("mouseup",(function(e){a=void 0,t=void 0,r=void 0}))}function n(e,t){return window.getComputedStyle(e,null).getPropertyValue(t)}let y;d.innerHTML="";for(let b=0;b<t;b++)y=g.cloneNode(!0),y.querySelector(".table_column_name").innerHTML=b+1,y.setAttribute("column-id",b),a(y),d.appendChild(y);u.innerHTML="",Object.entries(e).forEach(((e,t)=>{let a=e[0],n=e[1],r=0,s=h.cloneNode(!0);s.removeChild(s.querySelector(".table_page_panel")),s.querySelector(".page_num").innerHTML=a,Object.entries(n).forEach(((e,a)=>{let n=e[1],i=e[0],l=f.cloneNode(!0);l.querySelector(".panel_num").innerHTML=i,l.removeChild(l.querySelector(".table_row")),n.forEach(((e,n)=>{let s=m.cloneNode(!0);s.innerHTML="",e.forEach(((e,i)=>{let l=v.cloneNode(!0),c=`${t}-${a}-${n}-${i}`;l.setAttribute("page-id",t),l.setAttribute("cell-id",c),l.setAttribute("row-id",r),l.setAttribute("column-id",i),l.innerHTML=e+(o?" ["+[t,i,r].join(", ")+"]":""),s.appendChild(l),l.onclick=k,p[c]=e})),e.length>0&&r++,l.appendChild(s)})),s.appendChild(l)})),u.appendChild(s)})),i.style.display="none",c.style.display="",l.style.display="",l.classList.remove("closed"),w()}catch(_){console.log(_),r.showDialog("An error occurred while setting up the script table.<br>"+_.message,"Error")}}(...e):w()}))}function E(){const e=app.activeDocument;S&&e.selection[0]instanceof ID.TextFrame&&""==e.selection[0].contents&&null==e.selection[1]&&function(){if(!p||!I)return;const e=app.activeDocument,t=I.getAttribute("cell-id");let a=p[t],r=e.selection[0];const o=n.getItem("setting_paste_mode");"paste_rich"!=o&&o?(a=a.replace(/<\/?[^>]+(>|$)/g,""),r.contents=a,"only_rich_text"!=n.getItem("setting_fit_overset_frames")&&H(r)):(r.contents=a,function(e){const t=app.activeDocument;if(!d){var a=t.characterStyles.itemByName(s.name);d=a.isValid?a:t.characterStyles.add(s)}if(!u){var n=t.characterStyles.itemByName(l.name);u=n.isValid?n:t.characterStyles.add(l)}if(!g){var r=t.characterStyles.itemByName(c.name);g=r.isValid?r:t.characterStyles.add(c)}B(e,"<b>","</b>",d),B(e,"<i>","</i>",u)}(r)),R()||D()}()}const H=function(e){e&&!e.overflows||(A(e,1),H(e))},A=function(e,t){e.geometricBounds=L(e.geometricBounds,[-1*t,-1*t,t,t])},L=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2],e[3]+t[3]]};function B(e,t,a,r){var o,s,l,c=e.characters,p=n.getItem("setting_fit_overset_frames");for(!e.overflows||p&&"only_rich_text"==p&&!e.contents.match(/<.+>/)||H(e),i=0;i<c.count()-a.length;i++)if(s=void 0,(o=c.itemByRange(i,i+t.length-1).contents.join("").toLowerCase())==t){for(s=i+t.length,l=void 0,j=s;null==l&&j<c.count()-a.length+1;j++)o=c.itemByRange(j,j+a.length-1).contents.join("").toLowerCase(),null==l&&o==a&&(l=j-1);if(null!=s&&null==l&&(l=c.count()-1),null!=s&&null!=l){let t=[];if(r.name==u.name){let e;for(let a=s;a<=l;a++){let n=c.item(a);e||n.appliedCharacterStyle.name!=d.name?e&&n.appliedCharacterStyle.name!=d.name?(t.push([e,a]),e=void 0):e&&a==l&&t.push([e,a]):e=a}}c.itemByRange(s,l).applyCharacterStyle(r),t.forEach((e=>{c.itemByRange(...e).applyCharacterStyle(g)})),e.overflows&&H(e),c.itemByRange(l+1,l+a.length).isValid&&c.itemByRange(l+1,l+a.length).remove(),c.itemByRange(i,s-1).remove()}}}function q(e){S&&R()}function O(e){S&&R("prev")}e.exports={setupButtons:function(){let e=document.getElementById("typeset_tool");e.querySelectorAll(".load_script").forEach((e=>e.onclick=C)),D(),d=void 0,u=void 0,g=void 0,e.querySelector(".control_wrapper .start").onclick=P,e.querySelector(".control_wrapper .stop").onclick=D,e.querySelectorAll(".toggle_settings").forEach((e=>e.onclick=f)),e.querySelector(".control_wrapper_toggle").onclick=function(e){return function(t){e.querySelector(".control_wrapper").classList.toggle("closed")}}(e),app.documents.length>0&&(app.activeDocument.removeEventListener("afterSelectionChanged",E),app.activeDocument.addEventListener("afterSelectionChanged",E)),function(){const e=document.querySelector(".overlay.settings .settings_body");m.forEach((t=>{let a=n.getItem(t);o&&console.log(t+" - "+a),a||(a=v[t],n.getItem(t,a),o&&console.log("Set to default value: "+a)),e.querySelector(`#${t}`).value=a,e.querySelector(`#${t} .${a}`).checked=!0}))}(),e.querySelectorAll(".load_script").forEach((e=>e.onclick=C)),e.querySelectorAll(".settings_body .setting_persist").forEach((e=>e.addEventListener("change",y)))},setupKeyboardShortcuts:function(){var e=app.scriptMenuActions.item("Manga Helper - Go to Next Row");e.isValid||(e=app.scriptMenuActions.add("Manga Helper - Go to Next Row")),e.removeEventListener("afterInvoke",q),e.addEventListener("afterInvoke",q);var t=app.scriptMenuActions.item("Manga Helper - Go to Previous Row");t.isValid||(t=app.scriptMenuActions.add("Manga Helper - Go to Previous Row")),t.removeEventListener("afterInvoke",O),t.addEventListener("afterInvoke",O)}}},923:e=>{e.exports={showDialog:function(e,t){const a=document.querySelector("dialog");a.querySelector(".title").innerHTML=t||"",a.querySelector(".message").innerHTML=e||"",a.show(),a.querySelector(".close").onclick=function(e){return t=>{e.close()}}(a)}}},881:()=>{}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var a=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](a,a.exports,__webpack_require__),a.exports}var __webpack_exports__={};(()=>{const e=__webpack_require__(656);function t(e){if(app.documents.length<1)return;const t="LEFT_TO_RIGHT"==e.target.value?ID.PageBindingOptions.LEFT_TO_RIGHT:ID.PageBindingOptions.RIGHT_TO_LEFT;app.activeDocument.documentPreferences.pageBinding=t}function a(){!function(){if(app.documents.length<1)return;const e=app.activeDocument.documentPreferences.pageBinding;e==ID.PageBindingOptions.DEFAULT_VALUE&&(e=ID.PageBindingOptions.LEFT_TO_RIGHT);const t=e.toString(),a=document.querySelector("#binding_direction");a.value=t,a.querySelector(`.${t}`).checked=!0}()}function n(){document.querySelector("#binding_direction").addEventListener("change",t),document.querySelector("#adjust-size-and-leading .increase").onclick=e.adjustSizeAndLeading.increase,document.querySelector("#adjust-size-and-leading .decrease").onclick=e.adjustSizeAndLeading.decrease,document.querySelector("#skew-frame .left").onclick=e.skewFrame.left,document.querySelector("#skew-frame .right").onclick=e.skewFrame.right,document.getElementById("refit-overset-frames").onclick=e.refitOversetFrames,document.getElementById("scale-pages").onclick=e.scalePages,document.getElementById("position-art").onclick=e.positionArt,document.getElementById("manga-em-dash").onclick=e.mangaEmDash,document.getElementById("pseudo-stroke").onclick=e.pseudoStroke,e.typeset.setupButtons(),e.typeset.setupKeyboardShortcuts()}app&&(a(),n(),app.addEventListener("afterContextChanged",(function(e){console.log("context change"),e&&e.eventPhase&&"DONE"!==e.eventPhase.toString()||app.documents.count()<1||!app.activeDocument||(a(),n())})))})()})();